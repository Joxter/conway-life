(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const nn=(e,t)=>e===t,on=Symbol("solid-track"),Je={equals:nn};let mr=vr;const fe=1,Qe=2,hr={owned:null,cleanups:null,context:null,owner:null};var A=null;let yt=null,M=null,F=null,se=null,st=0;function Ke(e,t){const r=M,n=A,o=e.length===0,i=t===void 0?n:t,s=o?hr:{owned:null,cleanups:null,context:i?i.context:null,owner:i},l=o?e:()=>e(()=>oe(()=>lt(s)));A=s,M=null;try{return Te(l,!0)}finally{M=r,A=n}}function gr(e,t){t=t?Object.assign({},Je,t):Je;const r={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},n=o=>(typeof o=="function"&&(o=o(r.value)),br(r,o));return[yr.bind(r),n]}function B(e,t,r){const n=Nt(e,t,!1,fe);He(n)}function sn(e,t,r){mr=mn;const n=Nt(e,t,!1,fe);(!r||!r.render)&&(n.user=!0),se?se.push(n):He(n)}function ke(e,t,r){r=r?Object.assign({},Je,r):Je;const n=Nt(e,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,He(n),yr.bind(n)}function ln(e){return Te(e,!1)}function oe(e){if(M===null)return e();const t=M;M=null;try{return e()}finally{M=t}}function an(e){sn(()=>oe(e))}function kt(e){return A===null||(A.cleanups===null?A.cleanups=[e]:A.cleanups.push(e)),e}function cn(e,t){const r=Symbol("context");return{id:r,Provider:gn(r),defaultValue:e}}function un(e){return A&&A.context&&A.context[e.id]!==void 0?A.context[e.id]:e.defaultValue}function fn(e){const t=ke(e),r=ke(()=>Ct(t()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function yr(){if(this.sources&&this.state)if(this.state===fe)He(this);else{const e=F;F=null,Te(()=>et(this),!1),F=e}if(M){const e=this.observers?this.observers.length:0;M.sources?(M.sources.push(this),M.sourceSlots.push(e)):(M.sources=[this],M.sourceSlots=[e]),this.observers?(this.observers.push(M),this.observerSlots.push(M.sources.length-1)):(this.observers=[M],this.observerSlots=[M.sources.length-1])}return this.value}function br(e,t,r){let n=e.value;return(!e.comparator||!e.comparator(n,t))&&(e.value=t,e.observers&&e.observers.length&&Te(()=>{for(let o=0;o<e.observers.length;o+=1){const i=e.observers[o],s=yt&&yt.running;s&&yt.disposed.has(i),(s?!i.tState:!i.state)&&(i.pure?F.push(i):se.push(i),i.observers&&$r(i)),s||(i.state=fe)}if(F.length>1e6)throw F=[],new Error},!1)),t}function He(e){if(!e.fn)return;lt(e);const t=A,r=M,n=st;M=A=e,dn(e,e.value,n),M=r,A=t}function dn(e,t,r){let n;try{n=e.fn(t)}catch(o){return e.pure&&(e.state=fe,e.owned&&e.owned.forEach(lt),e.owned=null),e.updatedAt=r+1,wr(o)}(!e.updatedAt||e.updatedAt<=r)&&(e.updatedAt!=null&&"observers"in e?br(e,n):e.value=n,e.updatedAt=r)}function Nt(e,t,r,n=fe,o){const i={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:A,context:A?A.context:null,pure:r};return A===null||A!==hr&&(A.owned?A.owned.push(i):A.owned=[i]),i}function Ze(e){if(e.state===0)return;if(e.state===Qe)return et(e);if(e.suspense&&oe(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<st);)e.state&&t.push(e);for(let r=t.length-1;r>=0;r--)if(e=t[r],e.state===fe)He(e);else if(e.state===Qe){const n=F;F=null,Te(()=>et(e,t[0]),!1),F=n}}function Te(e,t){if(F)return e();let r=!1;t||(F=[]),se?r=!0:se=[],st++;try{const n=e();return pn(r),n}catch(n){r||(se=null),F=null,wr(n)}}function pn(e){if(F&&(vr(F),F=null),e)return;const t=se;se=null,t.length&&Te(()=>mr(t),!1)}function vr(e){for(let t=0;t<e.length;t++)Ze(e[t])}function mn(e){let t,r=0;for(t=0;t<e.length;t++){const n=e[t];n.user?e[r++]=n:Ze(n)}for(t=0;t<r;t++)Ze(e[t])}function et(e,t){e.state=0;for(let r=0;r<e.sources.length;r+=1){const n=e.sources[r];if(n.sources){const o=n.state;o===fe?n!==t&&(!n.updatedAt||n.updatedAt<st)&&Ze(n):o===Qe&&et(n,t)}}}function $r(e){for(let t=0;t<e.observers.length;t+=1){const r=e.observers[t];r.state||(r.state=Qe,r.pure?F.push(r):se.push(r),r.observers&&$r(r))}}function lt(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),n=e.sourceSlots.pop(),o=r.observers;if(o&&o.length){const i=o.pop(),s=r.observerSlots.pop();n<o.length&&(i.sourceSlots[s]=n,o[n]=i,r.observerSlots[n]=s)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)lt(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function hn(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function wr(e,t=A){throw hn(e)}function Ct(e){if(typeof e=="function"&&!e.length)return Ct(e());if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++){const n=Ct(e[r]);Array.isArray(n)?t.push.apply(t,n):t.push(n)}return t}return e}function gn(e,t){return function(n){let o;return B(()=>o=oe(()=>(A.context={...A.context,[e]:n.value},fn(()=>n.children))),void 0),o}}const yn=Symbol("fallback");function Kt(e){for(let t=0;t<e.length;t++)e[t]()}function bn(e,t,r={}){let n=[],o=[],i=[],s=0,l=t.length>1?[]:null;return kt(()=>Kt(i)),()=>{let c=e()||[],u,a;return c[on],oe(()=>{let h=c.length,d,p,f,g,w,b,y,v,S;if(h===0)s!==0&&(Kt(i),i=[],n=[],o=[],s=0,l&&(l=[])),r.fallback&&(n=[yn],o[0]=Ke(x=>(i[0]=x,r.fallback())),s=1);else if(s===0){for(o=new Array(h),a=0;a<h;a++)n[a]=c[a],o[a]=Ke(m);s=h}else{for(f=new Array(h),g=new Array(h),l&&(w=new Array(h)),b=0,y=Math.min(s,h);b<y&&n[b]===c[b];b++);for(y=s-1,v=h-1;y>=b&&v>=b&&n[y]===c[v];y--,v--)f[v]=o[y],g[v]=i[y],l&&(w[v]=l[y]);for(d=new Map,p=new Array(v+1),a=v;a>=b;a--)S=c[a],u=d.get(S),p[a]=u===void 0?-1:u,d.set(S,a);for(u=b;u<=y;u++)S=n[u],a=d.get(S),a!==void 0&&a!==-1?(f[a]=o[u],g[a]=i[u],l&&(w[a]=l[u]),a=p[a],d.set(S,a)):i[u]();for(a=b;a<h;a++)a in f?(o[a]=f[a],i[a]=g[a],l&&(l[a]=w[a],l[a](a))):o[a]=Ke(m);o=o.slice(0,s=h),n=c.slice(0)}return o});function m(h){if(i[a]=h,l){const[d,p]=gr(a);return l[a]=p,t(c[a],d)}return t(c[a])}}}function K(e,t){return oe(()=>e(t||{}))}const vn=e=>`Stale read from <${e}>.`;function $n(e){const t="fallback"in e&&{fallback:()=>e.fallback};return ke(bn(()=>e.each,e.children,t||void 0))}function Xt(e){const t=e.keyed,r=ke(()=>e.when,void 0,{equals:(n,o)=>t?n===o:!n==!o});return ke(()=>{const n=r();if(n){const o=e.children;return typeof o=="function"&&o.length>0?oe(()=>o(t?n:()=>{if(!oe(r))throw vn("Show");return e.when})):o}return e.fallback},void 0,void 0)}function wn(e,t,r){let n=r.length,o=t.length,i=n,s=0,l=0,c=t[o-1].nextSibling,u=null;for(;s<o||l<i;){if(t[s]===r[l]){s++,l++;continue}for(;t[o-1]===r[i-1];)o--,i--;if(o===s){const a=i<n?l?r[l-1].nextSibling:r[i-l]:c;for(;l<i;)e.insertBefore(r[l++],a)}else if(i===l)for(;s<o;)(!u||!u.has(t[s]))&&t[s].remove(),s++;else if(t[s]===r[i-1]&&r[l]===t[o-1]){const a=t[--o].nextSibling;e.insertBefore(r[l++],t[s++].nextSibling),e.insertBefore(r[--i],a),t[o]=r[i]}else{if(!u){u=new Map;let m=l;for(;m<i;)u.set(r[m],m++)}const a=u.get(t[s]);if(a!=null)if(l<a&&a<i){let m=s,h=1,d;for(;++m<o&&m<i&&!((d=u.get(t[m]))==null||d!==a+h);)h++;if(h>a-l){const p=t[s];for(;l<a;)e.insertBefore(r[l++],p)}else e.replaceChild(r[l++],t[s++])}else s++;else t[s++].remove()}}}const Gt="_$DX_DELEGATE";function Sn(e,t,r,n={}){let o;return Ke(i=>{o=i,t===document?e():E(t,e(),t.firstChild?null:void 0,r)},n.owner),()=>{o(),t.textContent=""}}function W(e,t,r){let n;const o=()=>{const s=document.createElement("template");return s.innerHTML=e,r?s.content.firstChild.firstChild:s.content.firstChild},i=t?()=>oe(()=>document.importNode(n||(n=o()),!0)):()=>(n||(n=o())).cloneNode(!0);return i.cloneNode=i,i}function Ne(e,t=window.document){const r=t[Gt]||(t[Gt]=new Set);for(let n=0,o=e.length;n<o;n++){const i=e[n];r.has(i)||(r.add(i),t.addEventListener(i,_n))}}function Yt(e,t,r){r==null?e.removeAttribute(t):e.setAttribute(t,r)}function Fe(e,t){t==null?e.removeAttribute("class"):e.className=t}function Y(e,t,r,n){if(n)Array.isArray(r)?(e[`$$${t}`]=r[0],e[`$$${t}Data`]=r[1]):e[`$$${t}`]=r;else if(Array.isArray(r)){const o=r[0];e.addEventListener(t,r[0]=i=>o.call(e,r[1],i))}else e.addEventListener(t,r)}function Jt(e,t,r={}){const n=Object.keys(t||{}),o=Object.keys(r);let i,s;for(i=0,s=o.length;i<s;i++){const l=o[i];!l||l==="undefined"||t[l]||(Qt(e,l,!1),delete r[l])}for(i=0,s=n.length;i<s;i++){const l=n[i],c=!!t[l];!l||l==="undefined"||r[l]===c||!c||(Qt(e,l,!0),r[l]=c)}return r}function xn(e,t,r){return oe(()=>e(t,r))}function E(e,t,r,n){if(r!==void 0&&!n&&(n=[]),typeof t!="function")return tt(e,t,n,r);B(o=>tt(e,t(),o,r),n)}function Qt(e,t,r){const n=t.trim().split(/\s+/);for(let o=0,i=n.length;o<i;o++)e.classList.toggle(n[o],r)}function _n(e){const t=`$$${e.type}`;let r=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==r&&Object.defineProperty(e,"target",{configurable:!0,value:r}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return r||document}});r;){const n=r[t];if(n&&!r.disabled){const o=r[`${t}Data`];if(o!==void 0?n.call(r,o,e):n.call(r,e),e.cancelBubble)return}r=r._$host||r.parentNode||r.host}}function tt(e,t,r,n,o){for(;typeof r=="function";)r=r();if(t===r)return r;const i=typeof t,s=n!==void 0;if(e=s&&r[0]&&r[0].parentNode||e,i==="string"||i==="number")if(i==="number"&&(t=t.toString()),s){let l=r[0];l&&l.nodeType===3?l.data=t:l=document.createTextNode(t),r=$e(e,r,n,l)}else r!==""&&typeof r=="string"?r=e.firstChild.data=t:r=e.textContent=t;else if(t==null||i==="boolean")r=$e(e,r,n);else{if(i==="function")return B(()=>{let l=t();for(;typeof l=="function";)l=l();r=tt(e,l,r,n)}),()=>r;if(Array.isArray(t)){const l=[],c=r&&Array.isArray(r);if(Pt(l,t,r,o))return B(()=>r=tt(e,l,r,n,!0)),()=>r;if(l.length===0){if(r=$e(e,r,n),s)return r}else c?r.length===0?Zt(e,l,n):wn(e,r,l):(r&&$e(e),Zt(e,l));r=l}else if(t.nodeType){if(Array.isArray(r)){if(s)return r=$e(e,r,n,t);$e(e,r,null,t)}else r==null||r===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);r=t}else console.warn("Unrecognized value. Skipped inserting",t)}return r}function Pt(e,t,r,n){let o=!1;for(let i=0,s=t.length;i<s;i++){let l=t[i],c=r&&r[i],u;if(!(l==null||l===!0||l===!1))if((u=typeof l)=="object"&&l.nodeType)e.push(l);else if(Array.isArray(l))o=Pt(e,l,c)||o;else if(u==="function")if(n){for(;typeof l=="function";)l=l();o=Pt(e,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||o}else e.push(l),o=!0;else{const a=String(l);c&&c.nodeType===3&&c.data===a?e.push(c):e.push(document.createTextNode(a))}}return o}function Zt(e,t,r=null){for(let n=0,o=t.length;n<o;n++)e.insertBefore(t[n],r)}function $e(e,t,r,n){if(r===void 0)return e.textContent="";const o=n||document.createTextNode("");if(t.length){let i=!1;for(let s=t.length-1;s>=0;s--){const l=t[s];if(o!==l){const c=l.parentNode===e;!i&&!s?c?e.replaceChild(o,l):e.insertBefore(o,r):c&&l.remove()}else i=!0}}else e.insertBefore(o,r);return[o]}function he(e,t){for(let r in e)t(e[r],r)}function I(e,t){e.forEach(t)}function T(e,t){if(!e)throw Error(t)}function ie({node:e=[],from:t,source:r,parent:n=t||r,to:o,target:i,child:s=o||i,scope:l={},meta:c={},family:u={type:"regular"},regional:a}={}){let m=Ie(n),h=Ie(u.links),d=Ie(u.owners),p=[];I(e,g=>g&&X(p,g));let f={id:zn(),seq:p,next:Ie(s),meta:c,scope:l,family:{type:u.type||"crosslink",links:h,owners:d}};return I(h,g=>X(at(g),f)),I(d,g=>X(ct(g),f)),I(m,g=>X(g.next,f)),a&&_e&&Ae(Be(_e),[f]),f}function le(e,t,r){let n,o=te,i=null,s=P;if(e.target&&(t=e.params,r=e.defer,n=e.meta,o="page"in e?e.page:o,e.stack&&(i=e.stack),s=me(e)||s,e=e.target),s&&P&&s!==P&&(P=null),Array.isArray(e))for(let p=0;p<e.length;p++)pe("pure",o,U(e[p]),i,t[p],s,n);else pe("pure",o,U(e),i,t,s,n);if(r&&!Ve)return;let l,c,u,a,m,h,d={isRoot:Ve,currentPage:te,scope:P,isWatch:Ge,isPure:Ye};Ve=0;e:for(;a=jn();){let{idx:p,stack:f,type:g}=a;u=f.node,te=m=f.page,P=me(f),m?h=m.reg:P&&(h=P.reg);let w=!!m,b=!!P,y={fail:0,scope:u.scope};l=c=0;for(let v=p;v<u.seq.length&&!l;v++){let S=u.seq[v];if(S.order){let{priority:x,barrierID:k}=S.order,z=k?m?`${m.fullID}_${k}`:k:0;if(v!==p||g!==x){k?vt.has(z)||(vt.add(z),Et(v,f,x,k)):Et(v,f,x);continue e}k&&vt.delete(z)}switch(S.type){case"mov":{let k,z=S.data;switch(z.from){case ge:k=Be(f);break;case"a":case"b":k=f[z.from];break;case"value":k=z.store;break;case"store":if(h&&!h[z.store.id])if(w){let gt=Lr(m,z.store.id);f.page=m=gt,gt?h=gt.reg:b?(Me(P,z.store,0,1,z.softRead),h=P.reg):h=void 0}else b&&Me(P,z.store,0,1,z.softRead);k=qe(h&&h[z.store.id]||z.store)}switch(z.to){case ge:f.value=k;break;case"a":case"b":f[z.to]=k;break;case"store":In(m,P,u,z.target).current=k}break}case"compute":let x=S.data;if(x.fn){Ge=L(u,"op")==="watch",Ye=x.pure;let k=x.safe?(0,x.fn)(Be(f),y.scope,f):qn(y,x.fn,f);x.filter?c=!k:f.value=k,Ge=d.isWatch,Ye=d.isPure}}l=y.fail||c}if(!l){let v=Be(f),S=me(f);if(I(u.next,x=>{pe("child",m,x,f,v,S)}),S){L(u,"needFxCounter")&&pe("child",m,S.fxCount,f,v,S),L(u,"storeChange")&&pe("child",m,S.storeChange,f,v,S),L(u,"warnSerialize")&&pe("child",m,S.warnSerializeNode,f,v,S);let x=S.additionalLinks[u.id];x&&I(x,k=>{pe("child",m,k,f,v,S)})}}}Ve=d.isRoot,te=d.currentPage,P=me(d)}function Sr(e,t="combine"){let r=t+"(",n="",o=0;return he(e,i=>{o<25&&(i!=null&&(r+=n,r+=re(i)?Lt(i).fullName:i.toString()),o+=1,n=", ")}),r+")"}function xr(e,t){let r,n,o=e;if(t){let i=Lt(t);e.length===0?(r=i.path,n=i.fullName):(r=i.path.concat([e]),n=i.fullName.length===0?e:i.fullName+"/"+e)}else r=e.length===0?[]:[e],n=e;return{shortName:o,fullName:n,path:r}}function Le(e,t){let r=t?e:e[0];Tr(r);let n=r.or,o=r.and;if(o){let i=t?o:o[0];if(Q(i)&&"and"in i){let s=Le(o,t);e=s[0],n={...n,...s[1]}}else e=o}return[e,n]}function q(e,...t){let r=zr();if(r){let n=r.handlers[e];if(n)return n(r,...t)}}function $(e,t){let r=ze({or:t,and:typeof e=="string"?{name:e}:e}),n=(s,...l)=>(ye(!L(n,"derived"),"call of derived event","createEvent"),ye(!Ye,"unit call from pure function","operators like sample"),te?((c,u,a,m)=>{let h=te,d=null;if(u)for(d=te;d&&d.template!==u;)d=ae(d);ir(d);let p=c.create(a,m);return ir(h),p})(n,o,s,l):n.create(s,l)),o=zr(),i=Object.assign(n,{graphite:ie({meta:Br(r.actualOp||"event",n,r),regional:1}),create:s=>(le({target:n,params:s,scope:P}),s),watch:s=>Rr(n,s),map:s=>$t(n,Ce,s,[ee()]),filter:s=>$t(n,"filter",s.fn?s:s.fn,[ee(jt,1)]),filterMap:s=>$t(n,"filterMap",s,[ee(),J(l=>!H(l),1)]),prepend(s){let l=$("* → "+n.shortName,{parent:ae(n)});return q("eventPrepend",U(l)),de(l,n,[ee()],"prepend",s),Ir(n,l),l}});return r!=null&&r.domain&&r.domain.hooks.event(i),Z(i,"id",i.graphite.id),Mr(i.graphite),i}function er(e,t,r,n){return nt(r,t,"first argument"),T(j(n),"second argument should be a function"),ye(!L(e,"derived"),`${t} in derived store`,`${t} in store created via createStore`),I(Array.isArray(r)?r:[r],o=>{e.off(o),rt(e).set(o,jr(qr(o,e,"on",Fn,n)))}),e}function _(e,t){let r=ze(t),n=be(e),o=$({named:"updates",derived:1});q("storeBase",n);let i=n.id,s={subscribers:new Map,updates:o,defaultState:e,stateRef:n,getState(){let d,p=n;if(te){let f=te;for(;f&&!f.reg[i];)f=ae(f);f&&(d=f)}return!d&&P&&(Me(P,n,1),d=P),d&&(p=d.reg[i]),qe(p)},setState:d=>le({target:s,params:d,defer:1,scope:P}),reset:(...d)=>(I(d,p=>er(s,".reset",p,()=>s.defaultState)),s),on:(d,p)=>er(s,".on",d,p),off(d){let p=rt(s).get(d);return p&&(p(),rt(s).delete(d)),s},map(d,p){let f,g;Q(d)&&(f=d,d=d.fn),ye(H(p),"second argument of store.map","updateFilter");let w=s.getState();H(w)||(g=d(w,p));let b=_(g,{name:`${s.shortName} → *`,derived:1,and:f}),y=qr(s,b,Ce,At,d);return ot(O(b),{type:Ce,fn:d,from:n}),O(b).noInit=1,q("storeMap",n,y),b},watch(d,p){if(!p||!re(d)){let f=Rr(s,d);return q("storeWatch",n,d)||d(s.getState()),f}return T(j(p),"second argument should be a function"),d.watch(f=>p(s.getState(),f))}},l=Br("store",s,r),c=s.defaultConfig.updateFilter;s.graphite=ie({scope:{state:n,fn:c},node:[J((d,p,f)=>(f.scope&&!f.scope.reg[n.id]&&(f.b=1),d)),ne(n),J((d,p,{a:f,b:g})=>!H(d)&&(d!==f||g),1),c&&ee(At,1),G({from:ge,target:n})],child:o,meta:{...l,defaultState:e},regional:1}),Z(s,"id",s.graphite.id),Z(s,"rootStateRefId",i);let u=L(s,"serialize"),a=L(s,"derived"),m=u==="ignore",h=L(s,"sid");return h&&(Z(s,"storeChange",1),n.sid=h),h||m||a||Z(s,"warnSerialize",1),T(a||!H(e),"current state can't be undefined, use null instead"),Ae(s,[o]),r!=null&&r.domain&&r.domain.hooks.store(s),a||(s.reinit=$({named:"reinit"}),s.reset(s.reinit)),n.meta=s.graphite.meta,Mr(s.graphite),s}function ue(...e){let t,r,n;[e,n]=Le(e);let o,i,s,l=e[e.length-1];if(j(l)?(r=e.slice(0,-1),t=l):r=e,r.length===1){let c=r[0];D(c)||(o=c,i=1)}if(!i&&(o=r,t)){s=1;let c=t;t=u=>c(...u)}return T(Q(o),"shape should be an object"),On(Array.isArray(o),!s,o,n,t)}function _r(){let e={};return e.req=new Promise((t,r)=>{e.rs=t,e.rj=r}),e.req.catch(()=>{}),e}function Ft(e,t={}){let r=ze(j(e)?{handler:e}:e,t),n=$(j(e)?{handler:e}:e,{...t,actualOp:"effect"}),o=U(n);Z(o,"op",n.kind="effect"),n.use=d=>(T(j(d),".use argument should be a function"),a.scope.handler=d,n),n.use.getCurrent=()=>a.scope.handler;let i=n.finally=$({named:"finally",derived:1}),s=n.done=i.filterMap({named:"done",fn({status:d,params:p,result:f}){if(d==="done")return{params:p,result:f}}}),l=n.fail=i.filterMap({named:"fail",fn({status:d,params:p,error:f}){if(d==="fail")return{params:p,error:f}}}),c=n.doneData=s.map({named:"doneData",fn:({result:d})=>d}),u=n.failData=l.map({named:"failData",fn:({error:d})=>d}),a=ie({scope:{handler:n.defaultConfig.handler||(()=>T(0,`no handler used in ${n.getType()}`))},node:[J((d,p,f)=>{let g=p.handler,w=me(f);if(w){let b=w.handlers.unitMap.get(n)||w.handlers.sidMap[n.sid];b&&(g=b)}return d.handler=g,d},0,1),J(({params:d,req:p,handler:f,args:g=[d]},w,b)=>{let y=Dr(b),v=it(d,p,1,i,b,y),S=it(d,p,0,i,b,y),[x,k]=Or(f,S,g);x&&(Q(k)&&j(k.then)?k.then(v,S):v(k))},0,1)],meta:{op:"fx",fx:"runner"}});o.scope.runner=a,X(o.seq,J((d,{runner:p},f)=>{let g=ae(f)?{params:d,req:{rs(w){},rj(w){}}}:d;return f.meta||(f.meta={fxID:Tn()}),le({target:p,params:g,defer:1,scope:me(f),meta:f.meta}),g.params},0,1)),n.create=d=>{let p=_r(),f={params:d,req:p};if(P&&!Ge){let g=P;p.req.finally(()=>{Rn(g)}).catch(()=>{})}return le({target:n,params:f,scope:P}),p.req};let m=n.inFlight=_(0,{serialize:"ignore",named:(L(n,"name")||n.graphite.id)+".inFlight"}).on(n,d=>d+1).on(i,d=>d-1).map({fn:d=>d,named:"inFlight"});Z(i,"needFxCounter","dec"),Z(n,"needFxCounter",1);let h=n.pending=m.map({fn:d=>d>0,named:"pending"});return Ae(n,[i,s,l,c,u,h,m]),r!=null&&r.domain&&r.domain.hooks.effect(n),n}function tr(e){let t;[e,t]=Le(e,1);let{source:r,effect:n,mapParams:o}=e,i=Ft(e,t);Z(i,"attached",1);let s,{runner:l}=U(i).scope,c=J((a,m,h)=>{let d,{params:p,req:f,handler:g}=a,w=i.finally,b=Dr(h),y=it(p,f,0,w,h,b),v=h.a,S=Pe(g),x=1;if(o?[x,d]=Or(o,y,[p,v]):d=r&&S?v:p,x){if(!S)return a.args=[v,d],1;le({target:g,params:{params:d,req:{rs:it(p,f,1,w,h,b),rj:y}},page:h.page,defer:1,meta:h.meta})}},1,1);if(r){let a;D(r)?(a=r,Ae(a,[i])):(a=ue(r),Ae(i,[a])),s=[ne(O(a)),c]}else s=[c];l.seq.splice(1,0,...s),i.use(n);let u=ae(n);return u&&(Object.assign(Lt(i),xr(i.shortName,u)),i.defaultConfig.parent=u),Ir(n,i,"effect"),i}function kr(e,t){nt(e,"merge","first argument");let r=$({name:Sr(e,"merge"),derived:1,and:t});return de(e,r,[],"merge"),r}function Cr(e,t){let r=0;return I(Hn,n=>{n in e&&(T(e[n]!=null,Hr(t,n)),r=1)}),r}function C(...e){let t,r,n,o,[[i,s,l],c]=Le(e),u=1;return H(s)&&Q(i)&&Cr(i,"sample")&&(s=i.clock,l=i.fn,u=!i.greedy,o=i.filter,t=i.target,r=i.name,n=i.sid,i=i.source),qt("sample",s,i,o,t,l,r,c,u,1,0,n)}function Re(...e){let[[t,r],n]=Le(e);return r||(r=t,t=r.source),Cr(r,"guard"),qt("guard",r.clock,t,r.filter,r.target,null,r.name,n,!r.greedy,0,1)}function kn(e,t,r){if(D(e))return ye(0,"restore($store)"),e;if(Pr(e)||Pe(e)){let o=ae(e),i=_(t,{parent:o,name:e.shortName,and:r});return de(Pe(e)?e.doneData:e,i),o&&o.hooks.store(i),i}let n=Array.isArray(e)?[]:{};return he(e,(o,i)=>n[i]=D(o)?o:_(o,{name:i})),n}function Cn(...e){let t,r,n="split",[[o,i],s]=Le(e),l=!i;l&&(t=o.cases,i=o.match,r=o.clock,o=o.source);let c=D(i),u=!re(i)&&j(i),a=!c&&!u&&Q(i);T(re(o),"source must be a unit"),t||(t={}),l?he(t,(f,g)=>Nr(n,f,`cases.${g}`)):(T(a,"match should be an object"),he(i,(f,g)=>t[g]=$({derived:1,named:`cases.${g}`,and:s})),t.__=$({derived:1,named:"cases.__",and:s}));let m,h=new Set([].concat(o,r||[],Object.values(t))),d=Object.keys(c||u?t:i);if(c||u)c&&h.add(i),m=[c&&ne(O(i),0,1),Ee({safe:c,filter:1,pure:!c,fn(f,g,w){let b=String(c?w.a:i(f));St(g,rr(d,b)?b:"__",f,w)}})];else if(a){let f=be({});f.type="shape";let g,w=[];he(i,(b,y)=>{if(re(b)){g=1,X(w,y),h.add(b);let v=de(b,[],[ne(f),J((S,x,{a:k})=>k[y]=S)]);if(D(b)){f.current[y]=b.getState();let S=O(b);ot(f,{from:S,field:y,type:"field"}),q("splitMatchStore",S,v)}}}),g&&q("splitBase",f),m=[g&&ne(f,0,1),ee((b,y,v)=>{for(let S=0;S<d.length;S++){let x=d[S];if(rr(w,x)?v.a[x]:i[x](b))return void St(y,x,b,v)}St(y,"__",b,v)},1)]}else T(0,"expect match to be unit, function or object");let p=ie({meta:{op:n},parent:r?[]:o,scope:t,node:m,family:{owners:Array.from(h)},regional:1});if(r&&qt(n,r,o,null,p,null,n,s,0,0,0),!l)return t}function Pn(e,{scope:t,safe:r}={}){T(t||P||r,"scopeBind cannot be called outside of forked .watch");let n=t||P;return Pe(e)?o=>{let i=_r();return le({target:e,params:{params:o,req:i},scope:n}),i.req}:o=>(le({target:e,params:o,scope:n}),o)}let An=typeof Symbol<"u"&&Symbol.observable||"@@observable",Ce="map",ge="stack",U=e=>e.graphite||e,at=e=>e.family.owners,ct=e=>e.family.links,O=e=>e.stateRef,Be=e=>e.value,rt=e=>e.subscribers,ae=e=>e.parent,me=e=>e.scope,L=(e,t)=>U(e).meta[t],Z=(e,t,r)=>U(e).meta[t]=r,Lt=e=>e.compositeName,re=e=>(j(e)||Q(e))&&"kind"in e;const Ue=e=>t=>re(t)&&t.kind===e;let D=Ue("store"),Pr=Ue("event"),Pe=Ue("effect"),Ar=Ue("domain"),En=Ue("scope");var xe={__proto__:null,unit:re,store:D,event:Pr,effect:Pe,domain:Ar,scope:En,attached:e=>Pe(e)&&L(e,"attached")==1};let rr=(e,t)=>e.includes(t),Xe=(e,t)=>{let r=e.indexOf(t);r!==-1&&e.splice(r,1)},X=(e,t)=>e.push(t),ye=(e,t,r)=>!e&&console.error(`${t} is deprecated${r?`, use ${r} instead`:""}`);const ut=()=>{let e=0;return()=>""+ ++e};let Mn=ut(),Er=ut(),zn=ut(),Tn=ut(),_e=null,Mr=e=>{},zr=()=>_e,Nn=e=>(e&&_e&&_e.sidRoot&&(e=`${_e.sidRoot}|${e}`),e),Ae=(e,t)=>{let r=U(e);I(t,n=>{let o=U(n);r.family.type!=="domain"&&(o.family.type="crosslink"),X(at(o),r),X(ct(r),o)})},Ie=(e=[])=>(Array.isArray(e)?e:[e]).flat().map(U),Q=e=>typeof e=="object"&&e!==null,j=e=>typeof e=="function",H=e=>e===void 0,Tr=e=>T(Q(e)||j(e),"expect first argument be an object");const nr=(e,t,r,n)=>T(!(!Q(e)&&!j(e)||!("family"in e)&&!("graphite"in e)),`${t}: expect ${r} to be a unit (store, event or effect)${n}`);let nt=(e,t,r)=>{Array.isArray(e)?I(e,(n,o)=>nr(n,t,`${o} item of ${r}`,"")):nr(e,t,r," or array of units")},Nr=(e,t,r="target")=>I(Ie(t),n=>ye(!L(n,"derived"),`${e}: derived unit in "${r}"`,"createEvent/createStore")),At=(e,{fn:t},{a:r})=>t(e,r),Fn=(e,{fn:t},{a:r})=>t(r,e),jt=(e,{fn:t})=>t(e);const Fr=(e,t,r,n)=>{let o={id:Er(),type:e,data:t};return r&&(o.order={priority:r},n&&(o.order.barrierID=++Ln)),o};let Ln=0,G=({from:e="store",store:t,target:r,to:n=r?"store":ge,batch:o,priority:i})=>Fr("mov",{from:e,store:t,to:n,target:r},i,o),Ee=({fn:e,batch:t,priority:r,safe:n=0,filter:o=0,pure:i=0})=>Fr("compute",{fn:e,safe:n,filter:o,pure:i},r,t),Rt=({fn:e})=>Ee({fn:e,priority:"effect"}),J=(e,t,r)=>Ee({fn:e,safe:1,filter:t,priority:r&&"effect"}),ne=(e,t,r)=>G({store:e,to:t?ge:"a",priority:r&&"sampler",batch:1}),ee=(e=jt,t)=>Ee({fn:e,pure:1,filter:t}),bt={mov:G,compute:Ee,filter:({fn:e,pure:t})=>Ee({fn:e,filter:1,pure:t}),run:Rt},be=e=>({id:Er(),current:e}),qe=({current:e})=>e,ot=(e,t)=>{e.before||(e.before=[]),X(e.before,t)},Se=null;const It=(e,t)=>{if(!e)return t;if(!t)return e;let r;return(e.v.type===t.v.type&&e.v.id>t.v.id||Mt(e.v.type)>Mt(t.v.type))&&(r=e,e=t,t=r),r=It(e.r,t),e.r=e.l,e.l=r,e},Bt=[];let or=0;for(;or<6;)X(Bt,{first:null,last:null,size:0}),or+=1;const jn=()=>{for(let e=0;e<6;e++){let t=Bt[e];if(t.size>0){if(e===3||e===4){t.size-=1;let n=Se.v;return Se=It(Se.l,Se.r),n}t.size===1&&(t.last=null);let r=t.first;return t.first=r.r,t.size-=1,r.v}}},pe=(e,t,r,n,o,i,s)=>Et(0,{a:null,b:null,node:r,parent:n,value:o,page:t,scope:i,meta:s},e),Et=(e,t,r,n=0)=>{let o=Mt(r),i=Bt[o],s={v:{idx:e,stack:t,type:r,id:n},l:null,r:null};o===3||o===4?Se=It(Se,s):(i.size===0?i.first=s:i.last.r=s,i.last=s),i.size+=1},Mt=e=>{switch(e){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},vt=new Set;let P,Ve=1,Ge=0,Ye=0,te=null,Rn=e=>{P=e},ir=e=>{te=e};const Lr=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=ae(e);if(e)return e}return null};let In=(e,t,r,n,o)=>{let i=Lr(e,n.id);return i?i.reg[n.id]:t?(Me(t,n,o),t.reg[n.id]):n};const Bn=e=>e;let Me=(e,t,r,n,o)=>{var i;let s=e.reg,l=t.sid,c=t==null||(i=t.meta)===null||i===void 0?void 0:i.serialize,u=e.fromSerialize&&c!=="ignore"&&c?.read||Bn;if(s[t.id])return;let a={id:t.id,current:t.current,meta:t.meta};if(a.id in e.values.idMap)a.current=e.values.idMap[a.id];else if(l&&l in e.values.sidMap&&!(l in e.sidIdMap))a.current=u(e.values.sidMap[l]);else if(t.before&&!o){let m=0,h=r||!t.noInit||n;I(t.before,d=>{switch(d.type){case Ce:{let p=d.from;if(p||d.fn){p&&Me(e,p,r,n);let f=p&&s[p.id].current;h&&(a.current=d.fn?d.fn(f):f)}break}case"field":m||(m=1,a.current=Array.isArray(a.current)?[...a.current]:{...a.current}),Me(e,d.from,r,n),h&&(a.current[d.field]=s[s[d.from.id].id].current)}})}l&&(e.sidIdMap[l]=t.id),s[t.id]=a};const qn=(e,t,r)=>{try{return t(Be(r),e.scope,r)}catch(n){console.error(n),e.fail=1,e.failReason=n}};let ze=(e,t={})=>(Q(e)&&(ze(e.or,t),he(e,(r,n)=>{H(r)||n==="or"||n==="and"||(t[n]=r)}),ze(e.and,t)),t);const sr=(e,t)=>{Xe(e.next,t),Xe(at(e),t),Xe(ct(e),t)},zt=(e,t,r)=>{let n;e.next.length=0,e.seq.length=0,e.scope=null;let o=ct(e);for(;n=o.pop();)sr(n,e),(t||r&&L(e,"op")!=="sample"||n.family.type==="crosslink")&&zt(n,t,L(n,"op")!=="on"&&r);for(o=at(e);n=o.pop();)sr(n,e),r&&n.family.type==="crosslink"&&zt(n,t,L(n,"op")!=="on"&&r)},je=e=>e.clear();let Tt=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),D(e))je(rt(e));else if(Ar(e)){r=1;let n=e.history;je(n.events),je(n.effects),je(n.stores),je(n.domains)}zt(U(e),!!t,r)},jr=e=>{let t=()=>Tt(e);return t.unsubscribe=t,t},de=(e,t,r,n,o)=>ie({node:r,parent:e,child:t,scope:{fn:o},meta:{op:n},family:{owners:[e,t],links:t},regional:1}),Rr=(e,t)=>(T(j(t),".watch argument should be a function"),jr(ie({scope:{fn:t},node:[Rt({fn:jt})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))),Ir=(e,t,r="event")=>{ae(e)&&ae(e).hooks[r](t)},Br=(e,t,r)=>{let n=ze(r),o=e==="domain",i=Mn(),{sid:s=null,named:l=null,domain:c=null,parent:u=c}=n,a=l||n.name||(o?"":i),m=xr(a,u),h={op:t.kind=e,name:t.shortName=a,sid:t.sid=Nn(s),named:l,unitId:t.id=i,serialize:n.serialize,derived:n.derived,config:n};return t.parent=u,t.compositeName=m,t.defaultConfig=n,t.thru=d=>(ye(0,"thru","js pipe"),d(t)),t.getType=()=>m.fullName,!o&&(t.subscribe=d=>(Tr(d),t.watch(j(d)?d:p=>d.next&&d.next(p))),t[An]=()=>t),h};const $t=(e,t,r,n)=>{let o;Q(r)&&(o=r,r=r.fn);let i=$({name:`${e.shortName} → *`,derived:1,and:o});return de(e,i,n,t,r),i},qr=(e,t,r,n,o)=>{let i=O(t),s=G({store:i,to:"a",priority:"read"});r===Ce&&(s.data.softRead=1);let l=[s,ee(n)];return q("storeOnMap",i,l,D(e)&&O(e)),de(e,t,l,r,o)},On=(e,t,r,n,o)=>{let i=e?p=>[...p]:p=>({...p}),s=e?[]:{},l=i(s),c=be(l),u=be(1);c.type=e?"list":"shape",c.noInit=1,q("combineBase",c,u);let a=_(l,{name:Sr(r),derived:1,and:n}),m=O(a);m.noInit=1,Z(a,"isCombine",1);let h=ne(c);h.order={priority:"barrier"};let d=[J((p,f,g)=>(g.scope&&!g.scope.reg[c.id]&&(g.c=1),p)),h,G({store:u,to:"b"}),J((p,{key:f},g)=>{if(g.c||p!==g.a[f])return t&&g.b&&(g.a=i(g.a)),g.a[f]=p,1},1),G({from:"a",target:c}),G({from:"value",store:0,target:u}),G({from:"value",store:1,target:u,priority:"barrier",batch:1}),ne(c,1),o&&ee()];return he(r,(p,f)=>{if(!D(p))return T(!re(p)&&!H(p),`combine expects a store in a field ${f}`),void(l[f]=s[f]=p);s[f]=p.defaultState,l[f]=p.getState();let g=de(p,a,d,"combine",o);g.scope.key=f;let w=O(p);ot(c,{type:"field",field:f,from:w}),q("combineField",w,g)}),a.defaultShape=r,ot(m,{type:Ce,from:c,fn:o}),a.defaultState=o?m.current=o(l):s,a};let Or=(e,t,r)=>{try{return[1,e(...r)]}catch(n){return t(n),[0,null]}},Dr=e=>{let t=me(e),r={ref:t};return t&&X(t.activeEffects,r),r},it=(e,t,r,n,o,i)=>s=>{i.ref&&Xe(i.ref.activeEffects,i),le({target:[n,Dn],params:[r?{status:"done",params:e,result:s}:{status:"fail",params:e,error:s},{value:s,fn:r?t.rs:t.rj}],defer:1,page:o.page,scope:i.ref,meta:o.meta})};const Dn=ie({node:[Rt({fn:({fn:e,value:t})=>e(t)})],meta:{op:"fx",fx:"sidechain"}}),Hn=["source","clock","target"],Hr=(e,t)=>e+`: ${t} should be defined`;let qt=(e,t,r,n,o,i,s,l,c,u,a,m)=>{let h=!!o;T(!H(r)||!H(t),Hr(e,"either source or clock"));let d=0;H(r)?d=1:re(r)||(r=ue(r)),H(t)?t=r:(nt(t,e,"clock"),Array.isArray(t)&&(t=kr(t))),d&&(r=t),l||s||(s=r.shortName);let p="none";(a||n)&&(re(n)?p="unit":(T(j(n),"`filter` should be function or unit"),p="fn")),o?(nt(o,e,"target"),Nr(e,o)):p==="none"&&u&&D(r)&&D(t)?o=_(i?i(qe(O(r)),qe(O(t))):qe(O(r)),{name:s,sid:m,or:l}):(o=$({name:s,derived:1,or:l}),q("sampleTarget",U(o)));let f=be(),g=[];if(p==="unit"){let[v,S]=lr(n,o,t,f,e);g=[...wt(S),...wt(v)]}let[w,b]=lr(r,o,t,f,e),y=de(t,o,[q("sampleSourceLoader"),G({from:ge,target:f}),...wt(b),ne(w,1,c),...g,ne(f),p==="fn"&&ee((v,S,{a:x})=>n(v,x),1),i&&ee(At),q("sampleSourceUpward",h)],e,i);return Ae(r,[y]),Object.assign(y.meta,l,{joint:1}),o};const wt=e=>[ne(e),J((t,r,{a:n})=>n,1)],lr=(e,t,r,n,o)=>{let i=D(e),s=i?O(e):be(),l=be(i);return i||ie({parent:e,node:[G({from:ge,target:s}),G({from:"value",store:1,target:l})],family:{owners:[e,t,r],links:t},meta:{op:o},regional:1}),q("sampleSource",l,s,n),[s,l]},St=(e,t,r,n)=>{let o=e[t];o&&le({target:o,params:Array.isArray(o)?o.map(()=>r):r,defer:1,stack:n})};function Ot(){return{width:window.visualViewport?.width||600,height:window.visualViewport?.height||400}}function ar(e,t,r){return{x:t.x-e.col*r,y:t.y-e.row*r}}function Un(e){let t=new Map;return e.forEach(({col:r,row:n})=>{t.has(r)||t.set(r,new Map),t.get(r).set(n,1)}),t}function Vn(e){let t=0,r=0,n=0;return e.size===0?{col:t,row:r}:(e.forEach((o,i)=>{n+=o.size,o.forEach((s,l)=>{t+=i,r+=l})}),{col:Math.round(t/n),row:Math.round(r/n)})}function Ur(e,t){try{let r=localStorage.getItem(e);return r===null?t:r}catch(r){return console.error(r),t}}function Vr(e,t){try{localStorage.setItem(e,t)}catch(r){console.error(r)}}function Wn(){return{currentBp:_(null)}}const we=Ot();function Kn(){const e="cellSize",t=[1,100];let r=+Ur(e,"10")||10;const n=_({size:r,prevSize:r}),o=_({width:we.width,height:we.height}),i=n.map(({size:a},m)=>({height:Math.ceil(we.height/a),width:Math.ceil(we.width/a),prevHeight:m&&m.height||Math.ceil(we.height/a),prevWidth:m&&m.width||Math.ceil(we.width/a)})),s=$(),l=$();let c=0;return document.addEventListener("wheel",a=>{c+=a.deltaY,c>20&&(l(),c=0),c<-20&&(s(),c=0)}),n.on(l,({size:a})=>({size:Math.max(t[0],a-1),prevSize:a})).on(s,({size:a})=>({size:Math.max(t[0],a+1),prevSize:a})),n.watch(a=>{Vr(e,String(a.size))}),{options:t,$cellSize:n,$fieldSize:i,plus:s,minus:l,$viewPortSize:o}}function Xn(){const e=$(),t=$(),r=_(null);return r.on(t,()=>null).on(e,(o,i)=>i),{$hoveredXY:r,fieldMouseLeaved:t,fieldMouseMoved:e}}function Gn(e,t){const r=_(null),n=_(null),o=_(null),i=$(),s=$(),l=$(),c=$(),u=$(),a=$(),m=$();function h(){document.addEventListener("mousedown",i),document.addEventListener("mouseup",s)}const d=e.map(f=>f!==null),p=e.map(f=>f==null);return o.on(i,()=>Date.now()),C({source:t,clock:i,filter:d,target:r}),C({source:e,clock:i,filter:d,target:n}),C({source:{currentHovered:e,initHovered:n,startTime:o},clock:s,filter:f=>!!f.initHovered&&!!f.currentHovered&&!!f.startTime,fn:({currentHovered:f,initHovered:g,startTime:w})=>({start:f,finish:g}),target:l}),C({source:{currentHovered:e,initFocus:r,initHovered:n},clock:e,filter:f=>!!f.initHovered&&!!f.initFocus&&!!f.currentHovered,fn:({currentHovered:f,initHovered:g,initFocus:w})=>({x:w.x+(f.x-g.x),y:w.y+(f.y-g.y)}),target:m}),Cn({source:l,match:f=>f.start.x===f.finish.x&&f.start.y===f.finish.y?"click":"dragEnd",cases:{click:u,dragEnd:a}}),C({clock:u,fn:f=>({coords:f.start}),target:c}),r.reset(l,p),n.reset(l,p),o.reset(l,p),{focusMoved:m,initEvents:h,clicked:c}}function Wr(e){var{timeout:t,start:r,stop:n,leading:o=!1,trailing:i=!1}=e,s=r??$({name:"setup",sid:"-ajedhm"}),l=n??$({name:"teardown",sid:"-ryi8gr"}),c=$({name:"tick",sid:"-cw8a02"}),u=_(!1,{name:"$isRunning",sid:"-5gspmy"}),a=Yn(t),m=u.map(b=>!b),h=$({name:"saveTimeout",sid:"satd6r"}),d=_(null,{name:"$timeoutId",sid:"hehxq7"}).on(h,(b,y)=>{var{timeoutId:v}=y;return v}),p=_(()=>{},{name:"$rejecter",sid:"-sc3eh9"}).on(h,(b,y)=>{var{reject:v}=y;return v}),f=tr({and:{source:{timeout:a,running:u},effect:b=>{var{timeout:y,running:v}=b;return v?new Promise((S,x)=>{var k=setTimeout(S,y);h({timeoutId:k,reject:x})}):Promise.reject()}},or:{name:"timeoutFx",sid:"-xlxric"}}),g=tr({and:{source:{timeoutId:d,rejecter:p},effect:b=>{var{timeoutId:y,rejecter:v}=b;v(),y&&clearTimeout(y)}},or:{name:"cleanupFx",sid:"-32ewxw"}});if(Re({and:[{clock:s,source:a,filter:m,target:f}],or:{sid:"-us95i7"}}),o){var w=Re({and:[{clock:s,filter:m}],or:{name:"onReady",sid:"farho0"}});C({and:[{clock:w,target:c}],or:{sid:"-ubrbnn"}})}return C({and:[{clock:s,fn:()=>!0,target:u}],or:{sid:"-ua3xxa"}}),Re({and:[{clock:f.done,source:a,filter:u,target:f}],or:{sid:"6lcmx8"}}),Re({and:[{clock:f.done,filter:u,target:c.prepend(()=>{})}],or:{sid:"6p772r"}}),i&&C({and:[{clock:l,target:c}],or:{sid:"75p0xb"}}),u.on(l,()=>!1),C({and:[{clock:l,target:g}],or:{sid:"7ln232"}}),{tick:c,isRunning:u,"@@trigger":()=>({setup:s,teardown:l,fired:c})}}function Yn(e){if(xe.store(e,{sid:"8i2x6t"}))return e;if(typeof e=="number")return _(e,{and:{name:"$timeout"},sid:"-jluixv"});throw new TypeError('timeout parameter in interval method should be number or Store. "'.concat(typeof e,'" was passed'))}function cr(e){var{source:t,timeout:r,target:n=$({name:"target",sid:"r328r6"},{name:"target",sid:"r328r6"})}=e;if(!xe.unit(t))throw new TypeError("source must be unit from effector");var o=Jn(r),i=Ft(u=>new Promise(a=>setTimeout(a,u)),{name:"timerFx",sid:"-pyjx8k"}),s=_(null,{and:{serialize:"ignore"},name:"$payload",sid:"hinjft"}).on(t,(u,a)=>a),l=$({name:"triggerTick",sid:"-sf8sou"}),c=_(!0,{and:{serialize:"ignore"},name:"$canTick",sid:"-m0cqc"}).on(l,()=>!1).on(n,()=>!0);return Re({and:[{clock:t,filter:c,target:l}],or:{sid:"-hzhj9b"}}),C({and:[{source:o,clock:l,target:i}],or:{sid:"-hkn38k"}}),C({and:[{source:s,clock:i.done,target:n}],or:{sid:"-hhcboe"}}),n}function Jn(e){if(xe.store(e,{sid:"-h0ap6r"}))return e;if(typeof e=="number"){if(e<0||!Number.isFinite(e))throw new Error('timeout must be positive number or zero. Received: "'.concat(e,'"'));return _(e,{and:{name:"$timeout"},sid:"-h97n10"})}throw new TypeError('timeout parameter should be number or Store. "'.concat(typeof e,'" was passed'))}function Qn(e,t,r){const n=_(0),o=_({prev:0,delta:0}).reset(t),i=$(),s=$(),l=cr({source:i,timeout:100}),c=cr({source:r,timeout:300}),u=Wr({timeout:1e3,start:s});n.on(l,(h,d)=>d),C({source:{stepsPerSec:o,steps:e},clock:u.tick,fn:({stepsPerSec:h,steps:d})=>({prev:d,delta:d-h.prev}),target:o});const a=[];s(),m();function m(){window.requestAnimationFrame(()=>{const h=performance.now();for(;a.length>0&&a[0]<=h-1e3;)a.shift();a.push(h),m()}),i(a.length)}return{$fps:n,$stepsPerSec:o.map(h=>h.delta),$time:kn(c,0)}}function Zn(e,t){const r="expectedStepsPerSec";let n=+Ur(r,"10")||10;const o=$(),i=$(),s=$(),l=$(),c=$(),u=$(),a=_(!1),m=_(0),h=[1,200],d=_(n),p=d.map(y=>1e3/y),f=$(),g=$(),w=_(null),b=Wr({timeout:p,start:i,stop:kr([l,s,u])});return C({clock:[b.tick,i,c],filter:ue(a,t,(y,v)=>y&&!v),target:o}),C({clock:c,target:o}),C({source:e,clock:i,fn:y=>new Map(y),target:w}),a.on(i,()=>!0).on([s,l],()=>!1).reset(u),d.on(f,y=>{if(y===1)return 5;let v=y+5;return v>h[1]?h[1]:v}).on(g,y=>{let v=y-5;return v<1?1:v}),w.on(u,()=>null),m.on(o,y=>y+1).on(s,()=>0).reset(u),d.watch(y=>{Vr(r,String(y))}),{$currentStep:m,$expectedStepsPerSec:d,$isRunning:a,$startFauna:w,start:i,stop:s,pause:l,incExpectedStepsPerSec:f,decExpectedStepsPerSec:g,speedRange:h,gameTick:o,reset:u,oneStep:c}}const N=Kn(),Oe=Xn();Wn();const V=_({fauna:Un([]),time:0,size:0}),eo=_([]),Kr=_(!1),Dt=$(),ft=$();Kr.on(Dt,()=>!0).on(ft,()=>!1);const R=Zn(V.map(e=>e.fauna),Kr),xt=Qn(R.$currentStep,R.reset,ft.map(e=>e.time)),ce=_({x:0,y:0}),to=$(),Ht=$(),Ut=$(),Vt=Gn(Oe.$hoveredXY,ce);C({source:[ce,Oe.$hoveredXY],clock:N.$cellSize,fn:([e,t],{size:r,prevSize:n})=>{if(t){let o={col:(t.x-e.x)/n,row:(t.y-e.y)/n};return ar(o,t,r)}else{let o=Ot(),i={x:o.width/2,y:o.height/2},s={col:(i.x-e.x)/n,row:(i.y-e.y)/n};return ar(s,i,r)}},target:ce});const Xr=ue(V,ce,N.$cellSize,N.$viewPortSize,({fauna:e},t,{size:r},n)=>{const o=[];return e.forEach((i,s)=>{i.forEach((l,c)=>{const u=s*r+t.x,a=c*r+t.y;u>=0&&u<n.width&&a>=0&&a<n.height&&o.push([u,a])})}),o}),ro=ue(Xr,V,(e,t)=>({fieldCellsAmount:e.length,faunaCellsAmount:t.size})),no=ue(eo,N.$fieldSize,N.$cellSize,ce,(e,{width:t,height:r},{size:n},o)=>{const i=[];return e.forEach(({col:s,row:l,label:c})=>{const u=s+o.x/n,a=l+o.y/n;u>=0&&u<t&&a>=0&&a<r&&i.push({col:u,row:a,label:c})}),i}),oo=ue(Xr,N.$cellSize,(e,t)=>({size:t,field:e})),io=ue(Oe.$hoveredXY,N.$cellSize,ce,(e,{size:t},r)=>{if(e){const n=Math.floor((e.x-r.x)/t),o=Math.floor((e.y-r.y)/t),i=(n*t+r.x).toFixed(0),s=(o*t+r.y).toFixed(0);return[{x:i,y:s}]}return[]}),so=ue(no,N.$cellSize,(e,{size:t})=>e.map(({row:r,col:n,label:o})=>({y:r*t+"px",x:n*t+"px",label:o})));C({source:V,clock:R.gameTick,fn:e=>e.fauna,target:Dt});V.on(ft,(e,t)=>t).reset(Ut);ce.on(Vt.focusMoved,(e,t)=>t).reset(to);C({source:{faunaData:V,fieldSize:N.$fieldSize,cellSize:N.$cellSize},clock:Ht,fn:({faunaData:e,fieldSize:t,cellSize:r})=>{const n=Vn(e.fauna);return{x:(t.width/2-n.col)*r.size,y:(t.height/2-n.row)*r.size}},target:ce});C({source:{faunaData:V,screenOffsetXY:ce,cellSize:N.$cellSize},clock:Vt.clicked,fn:({faunaData:e,screenOffsetXY:t,cellSize:{size:r}},{coords:n})=>{const o=new Map(e.fauna),i=Math.floor((n.x-t.x)/r),s=Math.floor((n.y-t.y)/r);return o.has(i)||o.set(i,new Map),o.get(i).has(s)?o.get(i).delete(s):o.get(i).set(s,1),{...e,fauna:o}},target:V});const dt=_(`48b2o$48b2o4$27bo$27b3o10bo9b2o$21bo8bo7b3o8b2o$21b3o5b2o6bo11bo4bo$
24bo12b2o11bo3bo$13b2o8b2o18b3o7b2o$13b2o30bo$30b2o$30bobo8bo21b2o$32b
obo6b2obo11b2o5b2o$32bo9b2o11bob2o$15b2o41bo$14b2o$14bo4bo34bo$15bo3bo
8bob2o2b2o9b2o7b3o$8b3o7b2o9b2o2b2obo8bo3bo$10bo34bo4bo$49b2o$6bo41b2o
$6b2obo11b2o9bo$2o5b2o11bob2o6bobo$2o21bo8bobo$33b2o$19bo30b2o$10b2o7b
3o28b2o$10bo3bo11b2o$10bo4bo11bo6b2o$14b2o8b3o7bo$13b2o9bo10b3o$37bo4$
15b2o$15b2o!`),Gr=$(),Wt=$(),pt=$();$();$();dt.on(Gr,(e,t)=>t);const lo="b",ur="o";function Yr(e){let t=new Map;const r="b",n="o",o="$";let i="",s=0,l=0;for(let c=0;c<e.length;c++){let u=e[c];if(u.charCodeAt(0)>=48&&u.charCodeAt(0)<=57)i+=u;else{let a=+i||1;if(u===r)l+=a;else if(u===n)for(let m=0;m<a;m++)t.has(l)||t.set(l,new Map),t.get(l).set(s,1),l++;else u===o&&(s+=a,l=0);i=""}}return t}function ao(e){let t=1/0,r=-1/0,n=1/0,o=-1/0;for(let[i,s]of e.entries())for(let[l,c]of s.entries())i<n&&(n=i),i>o&&(o=i),l<t&&(t=l),l>r&&(r=l);return{top:t,bottom:r,left:n,right:o}}function Jr(e){let t=ao(e),r=t.right-t.left+1,n=t.bottom-t.top+1,o=Array(n).fill(0).map(()=>Array(r).fill(0));for(let[l,c]of e.entries())for(let[u,a]of c.entries())o[u-t.top][l-t.left]=1;return co(o.map(l=>s(l)).join("$"))+"!";function s(l){let c="",u=l[0],a=1;for(let m=1;m<l.length;m++){let h=l[m];if(u===h){a++;continue}a>1&&(c+=a),c+=u===0?lo:ur,u=h,a=1}return u===1&&(a>1&&(c+=a),c+=ur),c}}function co(e){let t="",r=0;for(let n=0;n<e.length;n++){let o=e[n];o!="$"?(r===1&&(t+="$"),r>1&&(t+=r+"$"),t+=o,r=0):r++}return t}const mt=_(fo()||[]),Qr=$(),Zr=$(),en=$(),ht=$(),tn=$();mt.on(Qr,(e,t)=>{let r=0;for(;e.find(n=>n.name===`save #${r}`);)r++;return[...e,{fauna:t,name:`save #${r}`,removed:!1}]}).on(Zr,(e,t)=>e.map(r=>r.name===t?{...r,removed:!0}:r)).on(en,(e,t)=>e.map(r=>r.name===t?{...r,removed:!1}:r));C({source:mt,target:Ft(e=>{uo("history",e)})});function uo(e,t){let r=t.filter(n=>!n.removed).map(({name:n,fauna:o})=>({rle:Jr(o),name:n}));localStorage.setItem(e,JSON.stringify(r))}function fo(){try{return(JSON.parse(localStorage.getItem("history")||"null")||[]).map(({rle:r,name:n})=>({fauna:Yr(r),name:n,removed:!1}))}catch(e){return console.error(e),[]}}C({source:V,clock:tn,fn:e=>e.fauna,target:Qr});C({source:mt,clock:ht,fn:(e,t)=>{const r=e.find(o=>o.name===t).fauna;return{fauna:new Map(r),time:0,size:0}},target:V});C({clock:[ht,Ut,Wt,pt],target:R.reset});C({source:V,clock:Wt,fn:({fauna:e})=>Jr(e),target:dt});C({source:dt,clock:pt,fn:e=>({fauna:Yr(e),time:0,size:0}),target:V});C({clock:[ht,pt],target:Ht});const fr="#5583e5",po="_field_iwpzv_1",mo="_cell_iwpzv_17",ho="_on1_iwpzv_25",go="_on2_iwpzv_28",yo="_hoveredCell_iwpzv_32",bo="_heartMode_iwpzv_36",vo="_label_iwpzv_44",We={field:po,cell:mo,on1:ho,on2:go,hoveredCell:yo,heartMode:bo,label:vo};function ve(e,t){var r;return((n,o)=>{let i=!xe.unit(n)&&typeof n=="object",s={};n&&"@@unitShape"in n?typeof n["@@unitShape"]=="function"?s=n["@@unitShape"]():_t("expect @@unitShape to be a function"):s=i?n:{unit:n};let l=Array.isArray(s),c=Object.entries(s),u=l?[]:{},a=[],m={},h={};for(let[p,f]of c)if(xe.store(f))if(m[f.graphite.id]){let g=m[f.graphite.id];u[p]=u[g],h[p]=u[g]}else{a.push(f),m[f.graphite.id]=p;let[g,w]=gr(dr(f,o));u[p]=g,h[p]=w}else xe.unit(f)||_t("expected useUnit argument to be a unit"),u[p]=o?Pn(f,{scope:o}):f;let d=[bt.compute({priority:"effect"}),bt.compute({priority:"sampler",batch:1}),bt.run({fn:()=>{ln(()=>{for(let p of a)h[m[p.graphite.id]](()=>dr(p,o))})}})];if(o){let p=ie({node:d}),f=o.additionalLinks,g=[];a.forEach(w=>{let b=w.graphite.id,y=f[b]||[];f[b]=y,y.push(p),g.push(y)}),kt(()=>{g.forEach(w=>{let b=w.indexOf(p);b!==-1&&w.splice(b,1)}),Tt(p)})}else{let p=ie({node:d,parent:a,family:{owners:a}});kt(()=>{Tt(p)})}return i?u:u.unit})(e,((n=1)=>{let o=un($o);return n&&!o&&_t("No scope found, consider adding <Provider> to app root"),o})((r=t?.forceScope)!==null&&r!==void 0?r:0))}let _t=e=>{throw Error(e)};const dr=(e,t)=>t?t.getState(e):e.getState();let $o=cn(null);const wo=W("<div><canvas>"),pr=W("<div>");function So(){let e=Ot(),[t,r,n]=ve([io,so,N.$cellSize]),o;return an(()=>{requestAnimationFrame(i);function i(){if(!o){console.warn("no canvas");return}let{size:{size:s},field:l}=oo.getState();const c=o.getContext("2d");if(!c){console.warn("no context");return}let{width:u,height:a}=o.getBoundingClientRect();c.clearRect(0,0,u,a),c.fillStyle=fr,c.beginPath(),s>10?l.forEach(m=>{c.rect(m[0]+1,m[1]+1,s-1,s-1)}):l.forEach(m=>{c.rect(m[0],m[1],s,s)}),c.fill(),requestAnimationFrame(i)}}),(()=>{const i=wo(),s=i.firstChild;return Y(i,"mouseleave",Oe.fieldMouseLeaved),i.$$mousemove=({clientX:l,clientY:c})=>Oe.fieldMouseMoved({x:l,y:c}),i.style.setProperty("--color1",fr),xn(l=>o=l,s),E(i,()=>t().map(l=>(()=>{const c=pr();return B(u=>{const a=l.x+"px",m=l.y+"px",h={[We.cell]:!0,[We.hoveredCell]:!0};return a!==u._v$5&&((u._v$5=a)!=null?c.style.setProperty("left",a):c.style.removeProperty("left")),m!==u._v$6&&((u._v$6=m)!=null?c.style.setProperty("top",m):c.style.removeProperty("top")),u._v$7=Jt(c,h,u._v$7),u},{_v$5:void 0,_v$6:void 0,_v$7:void 0}),c})()),null),E(i,()=>r().map(l=>(()=>{const c=pr();return E(c,()=>l.label),B(u=>{const a=l.x,m=l.y,h={[We.label]:!0};return a!==u._v$8&&((u._v$8=a)!=null?c.style.setProperty("left",a):c.style.removeProperty("left")),m!==u._v$9&&((u._v$9=m)!=null?c.style.setProperty("top",m):c.style.removeProperty("top")),u._v$10=Jt(c,h,u._v$10),u},{_v$8:void 0,_v$9:void 0,_v$10:void 0}),c})()),null),B(l=>{const c=We.field,u=n().size+"px",a=e.width,m=e.height;return c!==l._v$&&Fe(i,l._v$=c),u!==l._v$2&&((l._v$2=u)!=null?i.style.setProperty("--cellSize",u):i.style.removeProperty("--cellSize")),a!==l._v$3&&Yt(s,"width",l._v$3=a),m!==l._v$4&&Yt(s,"height",l._v$4=m),l},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),i})()}Ne(["mousemove"]);const xo="_roundBox_hgest_1",_o="_history_hgest_9",ko="_colorBtn_hgest_15",Co="_currentColor_hgest_22",Po="_arrowBtn_hgest_26",Ao="_whiteBox_hgest_54",De={roundBox:xo,history:_o,colorBtn:ko,currentColor:Co,arrowBtn:Po,whiteBox:Ao},Eo=W("<div><button>-</button><button>+");function rn(e){return(()=>{const t=Eo(),r=t.firstChild,n=r.nextSibling;return Y(r,"click",e.onMinusClicked,!0),E(t,()=>` ${e.value} `,n),Y(n,"click",e.onPlusClicked,!0),B(o=>{const i=e.class,s=e.value<=e.range[0],l=e.value>=e.range[1];return i!==o._v$&&Fe(t,o._v$=i),s!==o._v$2&&(r.disabled=o._v$2=s),l!==o._v$3&&(n.disabled=o._v$3=l),o},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()}Ne(["click"]);const Mo=W("<div><button>to center</button><div>");function zo(){const[e]=ve([N.$cellSize]);return Vt.initEvents(),(()=>{const t=Mo(),r=t.firstChild,n=r.nextSibling;return Y(r,"click",Ht,!0),n.style.setProperty("position","absolute"),n.style.setProperty("right","150px"),n.style.setProperty("bottom","20px"),n.style.setProperty("z-index","1"),E(n,K(rn,{get value(){return e().size},get onPlusClicked(){return N.plus},get onMinusClicked(){return N.minus},get range(){return N.options},get class(){return De.roundBox}})),B(()=>Fe(r,De.arrowBtn)),t})()}Ne(["click"]);const To=W("<button>STOP"),No=W("<button>START"),Fo=W("<p><button>Step</button>timer: ");function Lo(){let[e,t]=ve([R.$isRunning,R.$currentStep]);return(()=>{const r=Fo(),n=r.firstChild;return n.nextSibling,r.style.setProperty("display","flex"),r.style.setProperty("gap","4px"),r.style.setProperty("position","absolute"),Y(n,"click",R.oneStep,!0),E(r,K(Xt,{get when(){return e()},get children(){const o=To();return Y(o,"click",R.stop,!0),o.style.setProperty("color","#f8f8f8"),o.style.setProperty("background-color","#de4040"),o.style.setProperty("border","0"),o}}),null),E(r,K(Xt,{get when(){return!e()},get children(){const o=No();return Y(o,"click",R.start,!0),o.style.setProperty("color","#f8f8f8"),o.style.setProperty("background-color","#50c40e"),o.style.setProperty("border","0"),o}}),null),E(r,()=>`steps: ${t()}`,null),B(()=>Fe(r,De.whiteBox)),r})()}Ne(["click"]);const jo=W("<div><span>FPS: </span><span>STEPS PER SEC: </span><span>EXPECTED STEPS:</span><span>CALC TIME: <!> msec</span><span>CELLS: </span><span>CELLS ON SCREEN: ");function Ro(){const[e,t,r]=ve([xt.$stepsPerSec,xt.$time,xt.$fps]),[n,o]=ve([ro,R.$expectedStepsPerSec]);return(()=>{const i=jo(),s=i.firstChild;s.firstChild;const l=s.nextSibling;l.firstChild;const c=l.nextSibling,u=c.nextSibling,a=u.firstChild,m=a.nextSibling;m.nextSibling;const h=u.nextSibling;h.firstChild;const d=h.nextSibling;return d.firstChild,i.style.setProperty("position","absolute"),i.style.setProperty("display","grid"),i.style.setProperty("top","10px"),i.style.setProperty("right","10px"),E(s,r,null),E(l,e,null),E(i,K(rn,{get value(){return o()},get onPlusClicked(){return R.incExpectedStepsPerSec},get onMinusClicked(){return R.decExpectedStepsPerSec},get range(){return R.speedRange}}),u),E(u,t,m),E(h,()=>n().faunaCellsAmount,null),E(d,()=>n().fieldCellsAmount,null),B(()=>Fe(i,De.whiteBox)),i})()}const Io=W("<div><p>History: </p><button>Save"),Bo=W("<div><button>"),qo=W("<button>x");function Oo(){let[e]=ve([mt]);return(()=>{const t=Io(),r=t.firstChild,n=r.nextSibling;return r.style.setProperty("margin","0"),Y(n,"click",tn,!0),n.style.setProperty("margin-right","20px"),E(t,K($n,{get each(){return e()},children:o=>(()=>{const i=Bo(),s=i.firstChild;return s.$$click=()=>{o.removed?en(o.name):ht(o.name)},E(s,()=>o.removed?`restore ${o.name}`:o.name),E(i,(()=>{const l=ke(()=>!!o.removed);return()=>l()?null:(()=>{const c=qo();return c.$$click=()=>{Zr(o.name)},c})()})(),null),i})()}),null),B(()=>Fe(t,De.history)),t})()}Ne(["click"]);const Do=W("<div><div><h1>Game of Life</h1></div><button>Reset</button><div><button>Export</button><button>Import</button><br><textarea>");function Ho(){let[e]=ve([dt]);return(()=>{const t=Do(),r=t.firstChild;r.firstChild;const n=r.nextSibling,o=n.nextSibling,i=o.firstChild,s=i.nextSibling,l=s.nextSibling,c=l.nextSibling;return E(t,K(zo,{}),r),E(t,K(So,{}),r),r.style.setProperty("position","absolute"),r.style.setProperty("width","100%"),r.style.setProperty("background-color","rgba(255,255,255, 0.9)"),r.style.setProperty("border-bottom","1px solid #ccc"),E(r,K(Oo,{}),null),E(r,K(Lo,{}),null),E(t,K(Ro,{}),n),Y(n,"click",Ut,!0),n.style.setProperty("position","absolute"),n.style.setProperty("bottom","20px"),n.style.setProperty("left","20px"),o.style.setProperty("position","absolute"),o.style.setProperty("bottom","50px"),o.style.setProperty("left","20px"),Y(i,"click",Wt,!0),Y(s,"click",pt,!0),c.addEventListener("change",u=>Gr(u.target.value)),c.style.setProperty("font-size","8px"),c.style.setProperty("width","100%"),c.style.setProperty("height","100px"),c.style.setProperty("line-height","1"),B(()=>c.value=e()),t})()}Uo();function Uo(){const e=new Worker("./webworkerGo.js");e.addEventListener("message",t=>{ft(t.data)}),e.addEventListener("error",t=>{console.log("main.error err",t)}),Dt.watch(t=>{e.postMessage(t)})}Sn(()=>K(Ho,{}),document.querySelector("#app"));Ne(["click"]);
